(function(e){jQuery.fn.SegmentSlider=function(s){s=e.extend({segments:8,lineDur:5e3,segmentDur:2e3,segmentPhase:Math.floor(s.segmentDur/s.segments),linePosition:"bottom",lineHeight:"5px",lineColor:"red",lineOpacity:.5},s);let t=function(){function t(e){return e<h?e+1:0}function i(e){return e>0?e-1:h}function n(){I.addClass("disable"),P.addClass("disable"),p=!1,k.css("width","0"),l=t(u),w=!0,d=0==v?1:0;for(let e=v*c;e<(1+v)*c;e++)H.eq(e).css("bottom","0"),H.eq(e).css("top","auto");for(let e=d*c;e<(1+d)*c;e++)H.eq(e).css("top","0"),H.eq(e).css("botom","auto"),H.eq(e).css("height","0%");j[d].onload=function(){function e(e){H.eq(v*c+e).animate({height:"0%"},s.segmentDur,function(){e==c-1&&(I.removeClass("disable"),P.removeClass("disable"),o(),u=l,v=d)}),H.eq(d*c+e).animate({height:"100%"},s.segmentDur)}for(let e=d*c;e<(1+d)*c;e++)S[e].drawImage(j[d],deltaW*(e%c),0,deltaW,b,0,0,deltaW,b);for(let t=0;t<c;t++)setTimeout(e,s.segmentPhase*t,t)},j[d].src=g.eq(l).attr("src")}function a(){I.addClass("disable"),P.addClass("disable"),p=!1,k.css("width","0"),r=i(u),w=!0,d=0==v?1:0;for(let e=v*c;e<(1+v)*c;e++)H.eq(e).css("top","0"),H.eq(e).css("bottom","auto");for(let e=d*c;e<(1+d)*c;e++)H.eq(e).css("bottom","0"),H.eq(e).css("top","auto"),H.eq(e).css("height","0%");j[d].onload=function(){function e(e){H.eq(v*c+e).animate({height:"0%"},s.segmentDur,function(){e==c-1&&(I.removeClass("disable"),P.removeClass("disable"),o(),u=r,v=d)}),H.eq(d*c+e).animate({height:"100%"},s.segmentDur)}for(let e=d*c;e<(1+d)*c;e++)S[e].drawImage(j[d],deltaW*(e%c),0,deltaW,b,0,0,deltaW,b);for(let t=0;t<c;t++)setTimeout(e,s.segmentPhase*t,t)},j[d].src=g.eq(r).attr("src")}function o(){w=!1,p=!0,f||k.animate({width:"100%"},s.lineDur,n)}let l,r,d,c=s.segments,m=e(this),g=m.find("img"),h=g.length-1,u=0,f=!1,p=!1,w=!1,v=0,q=g.first().width(),b=g.first().height();deltaW=q/c;let C=b/q;m.wrap("<div class='segment-slider-wrapper-middle'></div>");let W=m.parent();W.wrap("<div class='segment-slider-wrapper-outer'></div>");let D=W.parent();D.css("width","100%"),D.css("max-width",q),D.css("margin","0 auto"),W.css("width","100%"),W.css("padding-bottom",100*C+"%"),W.css("position","relative"),m.css("width","100%"),m.css("height","100%"),m.css("overflow","hidden"),m.css("position","absolute");let y=m.find("div");y.css("position","absolute"),y.css("display","none"),m.append('<div class="segment-slider-arrow segment-slider-arrow-down"><div class="segment-slider-arrow-inner"></div></div>'),m.append('<div class="segment-slider-arrow segment-slider-arrow-up"><div class="segment-slider-arrow-inner"></div></div>');let I=m.children(".segment-slider-arrow-up"),P=m.children(".segment-slider-arrow-down");m.append('<div class="segment-slider-line"><div class="segment-slider-innerline"></div></div>');let x=m.children(".segment-slider-line");x.css(s.linePosition,"0"),x.css("height",s.lineHeight);let k=x.children(".segment-slider-innerline");k.css("background-color",s.lineColor),k.css("opacity",s.lineOpacity),o();for(let e=0;e<2*c;e++)m.append(`<canvas id="canvas${e}"></canvas>`);let Q=[],S=[],j=[];j[0]=new Image,j[1]=new Image;let H=m.children("canvas");for(let e=0;e<2*c;e++)Q[e]=document.getElementById(`canvas${e}`),S[e]=Q[e].getContext("2d"),S[e].imageSmoothingQuality="high",H.eq(e).css("position","absolute"),H.eq(e).attr("width",deltaW),H.eq(e).attr("height",b),H.eq(e).css("width",100/c+"%"),H.eq(e).css("left",e%c*100/c+"%");for(let e=0;e<c;e++)H.eq(e).css("bottom","0"),H.eq(e).css("height","100%");j[0].onload=function(){for(let e=0;e<c;e++)S[e].drawImage(j[0],deltaW*e,0,deltaW,b,0,0,deltaW,b)},j[0].src=g.eq(u).attr("src"),P.on("click",function(){w||n()}),I.on("click",function(){w||a()}),e(this).on("mouseenter",function(){f=!0,p&&(k.stop(),k.css("width","0%"),p=!1)}),e(this).on("mouseleave",function(){f=!1,w||(p=!0,f||k.animate({width:"100%"},s.lineDur,n))})};return this.each(t)}})(jQuery);